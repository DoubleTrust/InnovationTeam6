<!doctype html>
<html>
    <head>
        <meta http-equiv="refresh" content="300">
        <meta charset="utf-8">
            <title>page for teachers</title>
        <link href="css/main1.css" rel="stylesheet" />
        <link rel="stylesheet" type="text/css" href="litewebchat.css">
        <script src="js/jquery-3.5.1.min.js"></script>
        <script src="js/dialog.js"></script>

    </head>
    <style>

    </style>
    <body>
        <div id="video">
            <p style="text-align:center">Video</p>

            <!-- for highlight question -->
            <div id="highlighted_questions" style="text-align:right; visibility:hidden">
                <h1>Important questions</h1>
                <h2>What does VPC mean?</h2>
                <div>
                    <button onclick="changeVisibility_with_question()">Answer now</button>
                    <button onclick="changeVisibility()">Answer later</button>
                </div>          
            </div>

            <!-- for question export -->
            <div id="question_collections" style="text-align:center;margin:0 auto; width:300px; border-style: solid;visibility: hidden;">
                <a id="dlink" style="display:none;"></a>
                <table id="collected" class="table" style="background-color: #ffffff;">
                    <tbody>
                    <tr>
                        <th class="anchorjs-icon">Name</th>
                        <th class="anchorjs-icon">Question</th>
                        <th class="anchorjs-icon">Rating</th>
                    </tr>
                   <tr>
                        <td>Jeff</td>
                        <td>What does BMC mean here?</td>
                        <td>2</td>
                   </tr>
                    </tbody>
                </table>
                <button id="export" onclick=>Download</button>
            </div>
        </div>
            

        <div id="chat" style="font-size: 0"><!--取出两个button之间的间隙-->
                <button style="outline:none;border-radius:5px;background-color: paleturquoise;border: none;width: 50%;height: 100%" onclick="showDiv();">
                    Particiption</button>
                <button style="outline:none;border-radius:5px;background-color: paleturquoise;border: none;width: 50%;height: 100%" onclick="showDiv();">
                    Chat</button>

        </div>
        <div id="div1" class="col-md-7 agileits_mail_grid_left" style="display: block;background-color: #ffffff;border-radius:10px">
            <div class="lite-chatbox">
                <!-- cleft  -->
                <div class="cleft cmsg">
                    <span class="name">chenjunyu19</span>
                    <span id = "example_question" class="content">What does the VPC mean?</span>
                    <span id="example_rate" class="content">+5</span>
                </div>

                <div class="cleft cmsg">
                    <span class="name">SuperPaxxs</span>
                    <span class="content">What does BMC mean here?</span>
                    <span class="content" >+2</span>  
                </div>
            </div>
        </div>

        <div id="div2" class="col-md-7 agileits_mail_grid_left" style="display: none;background-color: #ffffff;border-radius:10px">
                    <table class="table" style="background-color: #ffffff">
                        <tbody>
                        <tr>
                            <th class="anchorjs-icon">勋章</th>
                            <th class="anchorjs-icon">对象</th>
                            <th class="anchorjs-icon">时间</th>
                        </tr>
                         <tr><td>勋章图片</td><td>Jeff</td> <tr/>
                         <tr><td>勋章图片</td><td>Anna</td> <tr/>
                         <tr><td>勋章图片</td><td>Tome</td> <tr/>
                         <tr><td>勋章图片</td><td>DIi</td> <tr/>

                        </tbody>
                    </table>
        </div>

        <div id="tools">



            <button id="voice" >Voice</button>
            <button id="uservidero">Video</button>
            <button id="rank">questions</button>
            <button id="collected_questions" onclick=change_collected_question_visibility()>Collected questions</button>

        <!-- 引入jquery.js -->
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script>


        <script>
            function change_collected_question_visibility()
            {
                document.getElementById("question_collections").style.visibility="visible";
            }
            function changeVisibility() // for highlighted students
            {
                document.getElementById("highlighted_questions").style.visibility="hidden";
            }
            function changeVisibility_with_question()
            {
                document.getElementById("highlighted_questions").style.visibility="hidden";
                document.getElementById("example_question").style.background="#72D6A0";
                document.getElementById("example_rate").style.visibility="hidden";
            }

            window.addEventListener("storage",function(e){
                var test =localStorage.getItem("question");
                document.getElementById("highlighted_questions").style.visibility = "visible";
    
            });
            
            var id = "collected",
                worksheetName = 'sheet',
                workName = "demo.xls";

            document.getElementById('export').onclick = function() {
                var download = tableToExcel();
                download(id, worksheetName, workName)
            };

            var tableToExcel = (function() {
                var uri = 'data:application/vnd.ms-excel;base64,',
                    template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
                    base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },
                    format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) };
                return function(table, name, filename) {
                    if (!table.nodeType) table = document.getElementById(table);
                    console.log(table.innerHTML)
                    var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }//此时的innerHTML数据可以自己自定义 比如json转化 只要值要数据符合即可
        
                    document.getElementById("dlink").href = uri + base64(format(template, ctx));
                    document.getElementById("dlink").download = filename;
                    document.getElementById("dlink").click();
                }
            });

            function showDiv() {
                var div1=document.getElementById("div1");
                var div2=document.getElementById("div2");

                if (div1.style.display==='block')
                    div1.style.display='none';
                else div1.style.display='block';
                if (div2.style.display==='block')
                    div2.style.display='none';
                else div2.style.display='block';
            }
            function openwin() {
                window.open ("rankpage.html", "height=100, width=400, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no")
}

        </script>
        </div>
        <div id="input">
            <textarea name="message here" id="textmessage" maxlength="100">
            </textarea>
            <button id="submit">Send</button>
        </div>

        <div id="background" class="back">
                <div id="poptop" class="content">
                    <div id="close">
                        <span id="close-button">×</span>
                        <h2>弹窗头部</h2>
                    </div>
                    <div id="poptitile">
                        <h3>弹窗标题</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iste, ullam, nisi, enim laboriosam ea cum necessitatibus ipsum cupiditate neque soluta qui autem odit eligendi blanditiis voluptatem repellat suscipit quia perspiciatis.</p>
                    </div>
                    <h3 id="foot">底部内容</h3>
                </div>
            </div>
        <script src="js/tc.js"></script>
    </body>

</html>